<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>照美丽的菜单（分页版）</title>
<style>
  body {
    font-family: "微软雅黑", sans-serif;
    background: #e7f0e7;
    margin: 0; padding: 0;
    color: #2b4d2b;
  }
  header {
    background: #3b7d3b;
    color: white;
    text-align: center;
    padding: 18px 0;
    font-size: 1.8em;
    font-weight: bold;
    box-shadow: 0 3px 5px rgba(0,0,0,0.1);
  }
  .container {
    max-width: 600px;
    margin: 12px auto;
    padding: 0 12px;
  }
  .menu-list {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
  }
  .dish {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    width: 48%;
    min-width: 140px;
    cursor: pointer;
    transition: transform 0.15s ease;
  }
  .dish:hover {
    transform: scale(1.03);
  }
  .dish img {
    width: 100%;
    height: 110px;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
    object-fit: cover;
  }
  .dish-info {
    padding: 8px;
    text-align: center;
  }
  .dish-name {
    font-weight: 600;
    margin-bottom: 4px;
  }
  .dish-price {
    color: #4a7a4a;
    font-weight: bold;
  }
  .selected {
    box-shadow: 0 0 12px 3px #2e7d32;
    border: 2px solid #2e7d32;
  }
  .order-summary {
    margin-top: 20px;
    background: #d7ecd7;
    border-radius: 8px;
    padding: 12px;
  }
  .order-summary h3 {
    margin-top: 0;
    font-weight: 700;
    color: #2b4d2b;
  }
  .order-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 6px;
  }
  .total-price {
    font-weight: 700;
    font-size: 1.2em;
    color: #1b3c1b;
    text-align: right;
  }
  button {
    background: #3b7d3b;
    border: none;
    color: white;
    font-size: 1.1em;
    padding: 12px 0;
    width: 100%;
    margin-top: 20px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  button:hover {
    background: #2e6d2e;
  }
  /* 添加菜单弹窗 */
  .modal-bg {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.4);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 100;
  }
  .modal {
    background: white;
    border-radius: 10px;
    max-width: 320px;
    width: 90%;
    padding: 16px;
  }
  .modal h3 {
    margin-top: 0;
    color: #2b4d2b;
  }
  .modal label {
    display: block;
    margin-top: 10px;
    font-weight: 600;
  }
  .modal input {
    width: 100%;
    padding: 6px;
    border: 1px solid #ccc;
    border-radius: 6px;
    margin-top: 4px;
  }
  .modal-buttons {
    margin-top: 18px;
    text-align: right;
  }
  .modal-buttons button {
    width: auto;
    padding: 8px 14px;
    margin-left: 8px;
  }
  .add-menu-btn {
    margin: 16px auto;
    display: block;
    max-width: 200px;
  }
  .pagination {
    margin-top: 12px;
    text-align: center;
  }
  .pagination button {
    margin: 0 6px;
    width: auto;
    padding: 8px 14px;
  }
</style>
</head>
<body>

<header>照美丽的菜单（分页版）</header>
<div class="container">

  <button class="add-menu-btn">➕ 添加菜单项</button>

  <div class="menu-list" id="menuList">
    <!-- 菜品列表动态生成 -->
  </div>

  <div class="pagination">
    <button id="prevPageBtn">上一页</button>
    <span id="pageInfo"></span>
    <button id="nextPageBtn">下一页</button>
  </div>

  <div class="order-summary" id="orderSummary" style="display:none;">
    <h3>已选菜单</h3>
    <div id="orderItems"></div>
    <div class="total-price" id="totalPrice">总价: ¥0</div>
  </div>

  <button id="submitOrder" style="display:none;">提交订单</button>
</div>

<!-- 添加菜单弹窗 -->
<div class="modal-bg" id="modalBg">
  <div class="modal">
    <h3>添加新菜单项</h3>
    <label for="dishName">菜名：</label>
    <input type="text" id="dishName" placeholder="输入菜名" />
    <label for="dishPrice">价格(元)：</label>
    <input type="number" id="dishPrice" placeholder="输入价格" />
    <label for="dishImg">图片链接：</label>
    <input type="url" id="dishImg" placeholder="输入图片链接（可选）" />
    <div class="modal-buttons">
      <button id="cancelBtn">取消</button>
      <button id="addBtn">添加</button>
    </div>
  </div>
</div>

<script>
  // 6道基础菜，后面自动扩展成100道示例
  let menuData = [
    {name: "宫保鸡丁", price: 28, img: "https://img.meishij.net/p/20150217/201502171039536181.jpg"},
    {name: "麻婆豆腐", price: 18, img: "https://img.meishij.net/p/20170823/201708231535088227611.jpg"},
    {name: "鱼香肉丝", price: 26, img: "https://img.meishij.net/p/20130508/2013050810120132052.jpg"},
    {name: "辣子鸡丁", price: 30, img: "https://img.meishij.net/p/20150623/201506231127399791873.jpg"},
    {name: "回锅肉", price: 32, img: "https://img.meishij.net/p/20150121/201501211333036162431.jpg"},
    {name: "酸菜鱼", price: 48, img: "https://img.meishij.net/p/20150625/201506251659534582928.jpg"},
  ];

  // 自动扩展成100道（复制基础菜，名字带序号区分）
  if(menuData.length < 100){
    let baseDishes = menuData.slice();
    for(let i=menuData.length; i<100; i++){
      let base = baseDishes[i % baseDishes.length];
      menuData.push({
        name: base.name + " " + (Math.floor(i / baseDishes.length) + 1),
        price: base.price + (i % 5),
        img: base.img
      });
    }
  }

  const pageSize = 12;
  let currentPage = 1;

  const menuList = document.getElementById("menuList");
  const orderSummary = document.getElementById("orderSummary");
  const orderItems = document.getElementById("orderItems");
  const totalPriceEl = document.getElementById("totalPrice");
  const submitOrderBtn = document.getElementById("submitOrder");

  const modalBg = document.getElementById("modalBg");
  const dishNameInput = document.getElementById("dishName");
  const dishPriceInput = document.getElementById("dishPrice");
  const dishImgInput = document.getElementById("dishImg");
  const cancelBtn = document.getElementById("cancelBtn");
  const addBtn = document.getElementById("addBtn");
  const addMenuBtn = document.querySelector(".add-menu-btn");

  const prevPageBtn = document.getElementById("prevPageBtn");
  const nextPageBtn = document.getElementById("nextPageBtn");
  const pageInfo = document.getElementById("pageInfo");

  let order = {};

  function renderMenu() {
    menuList.innerHTML = "";
    const start = (currentPage -1) * pageSize;
    const end = Math.min(start + pageSize, menuData.length);
    for(let i=start; i<end; i++) {
      const dish = menuData[i];
      const dishDiv = document.createElement("div");
      dishDiv.className = "dish";
      dishDiv.dataset.index = i;
      if(order[i]) dishDiv.classList.add("selected");
      dishDiv.innerHTML = `
        <img src="${dish.img || 'https://via.placeholder.com/300x180?text=无图'}" alt="${dish.name}" />
        <div class="dish-info">
          <div class="dish-name">${dish.name}</div>
          <div class="dish-price">¥${dish.price}</div>
        </div>
      `;
      dishDiv.addEventListener("click", () => toggleDish(i, dishDiv));
      menuList.appendChild(dishDiv);
    }
    pageInfo.textContent = `第 ${currentPage} 页 / 共 ${Math.ceil(menuData.length / pageSize)} 页`;
    updateOrderUI();
  }

  function toggleDish(index, element) {
    if(order[index]) {
      delete order[index];
      element.classList.remove("selected");
    } else {
      order[index] = 1;
      element.classList.add("selected");
    }
    updateOrderUI();
  }

  function updateOrderUI() {
    const keys = Object.keys(order);
    if(keys.length === 0) {
      orderSummary.style.display = "none";
      submitOrderBtn.style.display = "none";
      return;
    }
    orderSummary.style.display = "block";
    submitOrderBtn.style.display = "block";
    orderItems.innerHTML = "";
    let total = 0;
    keys.forEach(i => {
      const dish = menuData[i];
      const qty = order[i];
      total += dish.price * qty;
      const itemDiv = document.createElement("div");
      itemDiv.className = "order-item";
      itemDiv.textContent = `${dish.name} × ${qty}`;
      const priceSpan = document.createElement("span");
      priceSpan.textContent = `¥${dish.price * qty}`;
      itemDiv.appendChild(priceSpan);
      orderItems.appendChild(itemDiv);
    });
    totalPriceEl.textContent = `总价: ¥${total}`;
  }

  // 分页按钮事件
  prevPageBtn.onclick = () => {
    if(currentPage >1){
      currentPage--;
      renderMenu();
    }
  }
  nextPageBtn.onclick = () => {
    if(currentPage < Math.ceil(menuData.length / pageSize)){
      currentPage++;
      renderMenu();
    }
  }

  // 添加菜单弹窗
  addMenuBtn.onclick = () => {
    dishNameInput.value = "";
    dishPriceInput.value = "";
    dishImgInput.value = "";
    modalBg.style.display = "flex";
  }
  cancelBtn.onclick = () => {
    modalBg.style.display = "none";
  }
  addBtn.onclick = () => {
    const name = dishNameInput.value.trim();
    const price = parseFloat(dishPriceInput.value);
    let img = dishImgInput.value.trim();
    if(!name) { alert("请输入菜名"); return; }
    if(isNaN(price) || price <= 0) { alert("请输入正确价格"); return; }
    if(!img) img = "https://via.placeholder.com/300x180?text=无图";
    menuData.push({name, price, img});
    modalBg.style.display = "none";
    // 跳到最后一页新菜显示
    currentPage = Math.ceil(menuData.length / pageSize);
    renderMenu();
  }

  // 提交订单按钮功能：这里用Google表单收单
  submitOrderBtn.onclick = () => {
    const keys = Object.keys(order);
    if(keys.length === 0){
      alert("请选择至少一道菜");
      return;
    }
    // 组装订单文本
    let orderText = "";
    keys.forEach(i => {
      const dish = menuData[i];
      const qty = order[i];
      orderText += `${dish.name} × ${qty}; `;
    });

    // 你的Google表单提交URL，替换成你自己的
    const formAction = "https://docs.google.com/forms/d/e/1FAIpQLSerJIs1BXbw-80lN3okAEn5viTedr1D4uCiYgt51jz4HgvWrQ/formResponse";

    // 你表单里“订单内容”字段的entry ID
    const orderFieldName = "entry.1873846742";

    // 创建并提交表单
    const formData = new FormData();
    formData.append(orderFieldName, orderText);

    fetch(formAction, {
      method: "POST",
      mode: "no-cors",
      body: formData
    }).then(() => {
      alert("订单已提交，谢谢！");
      order = {};
      renderMenu();
    }).catch(() => {
      alert("提交失败，请稍后再试");
    });
  }

  // 初始化显示菜单
  renderMenu();

</script>

</body>
</html>